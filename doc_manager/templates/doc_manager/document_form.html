{% extends 'base.html' %}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/doc_manager/document_form.css' %}">
{% endblock %}

{% block content %}
<div class="row justify-content-center">
  <div class="col-md-8 col-lg-6">
    <div class="card shadow-lg border-0 p-4 mt-5 rounded-4">
      
      <!-- Title -->
      <h2 class="card-title text-center mb-4 fw-semibold text-primary">
        <i class="fas fa-file-upload me-2"></i>Upload New Document
      </h2>

      <!-- Info Alert -->
      <div class="alert alert-info small d-flex align-items-center" role="alert">
        <i class="fas fa-info-circle me-2"></i>
        <span><strong>Note:</strong> Only PDF/PNG/JPEG files are supported for RAG processing.</span>
      </div>

      <!-- Form -->
      <form method="POST" enctype="multipart/form-data" novalidate>
        {% csrf_token %}

        {% for field in form %}
          <div class="mb-3">
            <label for="{{ field.id_for_label }}" class="form-label fw-semibold">
              {{ field.label }}
            </label>

            {% if field.label == 'Title' %}
              <input type="text"
                     name="{{ field.name }}"
                     id="{{ field.id_for_label }}"
                     class="form-control"
                     placeholder="Enter a descriptive title"
                     value="{{ field.value|default_if_none:'' }}">
            {% elif field.field.widget.input_type == 'file' %}

              <div class="file-input-wrapper">
                <label class="file-label btn btn-outline-primary w-100" id="file-label">
                  <i class="fas fa-file-pdf me-2"></i>
                  <span id="file-label-text">Choose PDF file</span>
                  {{ field }}
                </label>
              </div>

            {% else %}
              {{ field }}
            {% endif %}

            {% for error in field.errors %}
              <div class="invalid-feedback d-block mt-1">{{ error }}</div>
            {% endfor %}
          </div>
        {% endfor %}

        <!-- Submit -->
        <button type="submit" class="btn btn-primary w-100 mt-4 py-2 fw-semibold">
          <i class="fas fa-cloud-upload-alt me-2"></i>Upload Document
        </button>
      </form>

      <hr class="my-4">

      <div class="text-center">
        <a href="{% url 'uploader_dashboard' %}" class="text-decoration-none small text-muted">
          <i class="fas fa-arrow-left me-1"></i> Back to Dashboard
        </a>
      </div>
    </div>
  </div>
</div>

{% block extra_js %}
<script src="{% static 'js/doc_manager/document_form.js' %}"></script>
{% endblock %}

{% endblock content %}